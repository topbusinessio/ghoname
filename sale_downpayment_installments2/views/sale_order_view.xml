<odoo>
    <record id="view_order_form_inherit_installments" model="ir.ui.view">
        <field name="name">sale.order.form.installments.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">

            <xpath expr="//sheet" position="inside">

                <!-- Hidden helper fields -->
                <field name="payment_type" invisible="1"/>
                <field name="show_installment_section" invisible="1"/>
                <field name="down_payment_locked" invisible="1"/>

                <!-- ======================== -->
                <!-- ðŸ’° Down Payment Section -->
                <!-- ======================== -->
                <group string="Down Payment"
                       invisible="not show_installment_section"
                       name="down_payment_section"
                       col="2">
                    <separator string="Down Payment Details" colspan="2"/>

                    <field name="down_payment_required" readonly="down_payment_locked"/>
                    <field name="down_payment_paid_now" readonly="down_payment_locked"/>
                    <field name="next_down_payment_amount" readonly="1"/>
                    <field name="down_payment_due_date" readonly="down_payment_locked"/>

                    <div class="oe_right oe_button_box" invisible="down_payment_locked">
                        <button name="action_register_down_payment"
                                string="Register Down Payment &amp; Generate Installments"
                                type="object"
                                class="btn btn-primary oe_highlight"
                                style="margin-top: 10px; width: 350px;"/>
                    </div>
                </group>

                <!-- ======================== -->
                <!-- ðŸ“… Installment Plan Section -->
                <!-- ======================== -->
                <group string="Installment Plan"
                       invisible="not show_installment_section"
                       name="installment_plan_section"
                       col="2">

                    <separator string="Installment Configuration" colspan="2"/>

                    <field name="installment_start_date" readonly="down_payment_locked"/>
                    <field name="first_installment_amount" readonly="down_payment_locked"/>
                    <field name="installment_months" readonly="down_payment_locked"/>
                    <field name="installment_breakdown" readonly="1" colspan="2"/>

                    <separator string="Installment Schedule" colspan="2"/>

                    <field name="installment_ids" readonly="1" colspan="2">
                        <tree editable="false">
                            <field name="installment_number"/>
                            <field name="amount"/>
                            <field name="due_date"/>
                            <field name="paid"/>
                            <field name="invoice_id"/>
                            <field name="locked" invisible="1"/>
                        </tree>
                    </field>
                </group>

            </xpath>
        </field>
    </record>
</odoo>

